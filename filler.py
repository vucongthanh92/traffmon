from threading import Thread

from traffmon import peru_analyzer

a = """1614179702000000000 0
1614180002000000000 0
1614180302000000000 0
1614180602000000000 0
1614180901000000000 0
1614181201000000000 0
1614181501000000000 0
1614181802000000000 0
1614182102000000000 0
1614182401000000000 0
1614182701000000000 0
1614183001000000000 0
1614183302000000000 0
1614183601000000000 0
1614183901000000000 0
1614184201000000000 0
1614184501000000000 0
1614184801000000000 0
1614185102000000000 0
1614185402000000000 0
1614185701000000000 0
1614186002000000000 0
1614186302000000000 0
1614186602000000000 0
1614186901000000000 0
1614187202000000000 0
1614187502000000000 0
1614187801000000000 0
1614188102000000000 0
1614188402000000000 0
1614188702000000000 0
1614189002000000000 0
1614189302000000000 0
1614189601000000000 0
1614189902000000000 0
1614190201000000000 0
1614190502000000000 0
1614190802000000000 0
1614191101000000000 0
1614191401000000000 0
1614191701000000000 0
1614192002000000000 0
1614192302000000000 0
1614192602000000000 0
1614192902000000000 0
1614193202000000000 0
1614193502000000000 0
1614193802000000000 0
1614194102000000000 0
1614194402000000000 0
1614194702000000000 0
1614195001000000000 0
1614195302000000000 0
1614195601000000000 0
1614195902000000000 0
1614196201000000000 0
1614196502000000000 0
1614196801000000000 0
1614197101000000000 0
1614197402000000000 0
1614197702000000000 0
1614198001000000000 0
1614198302000000000 0
1614198602000000000 0
1614198901000000000 0
1614199202000000000 0
1614199502000000000 0
1614199801000000000 0
1614200102000000000 0
1614200402000000000 0
1614200701000000000 0
1614201001000000000 0
1614201302000000000 0
1614201601000000000 0
1614201902000000000 0
1614202201000000000 0
1614202501000000000 0
1614202802000000000 0
1614203101000000000 0
1614203402000000000 0
1614203701000000000 0
1614204002000000000 0
1614204302000000000 0
1614204602000000000 0
1614204901000000000 0
1614205202000000000 0
1614205502000000000 0
1614205802000000000 0
1614206101000000000 0
1614206401000000000 0
1614206702000000000 0
1614207002000000000 0
1614207301000000000 0
1614207602000000000 0
1614207901000000000 0
1614208202000000000 0
1614208501000000000 0
1614208801000000000 0
1614209101000000000 0
1614209401000000000 0
1614209702000000000 0
1614210001000000000 0
1614210302000000000 0
1614210601000000000 0
1614210902000000000 0
1614211202000000000 0
1614211502000000000 0
1614211801000000000 0
1614212101000000000 0
1614212402000000000 0
1614212701000000000 0
1614213001000000000 0
1614213302000000000 0
1614213601000000000 0
1614213902000000000 0
1614214201000000000 0
1614214502000000000 0
1614214802000000000 0
1614215102000000000 0
1614215402000000000 0
1614215702000000000 0
1614216001000000000 0
1614216301000000000 0
1614216602000000000 0
1614216902000000000 0
1614217201000000000 0
1614217502000000000 0
1614217802000000000 0
1614218101000000000 0
1614218402000000000 0
1614218701000000000 0
1614219002000000000 0
1614219302000000000 0
1614219601000000000 0
1614219902000000000 0
1614220202000000000 0
1614220501000000000 0
1614220801000000000 0
1614221102000000000 0
1614221401000000000 0
1614221702000000000 0
1614222001000000000 0
1614222301000000000 0
1614222601000000000 0
1614222902000000000 0
1614223202000000000 0
1614223501000000000 0
1614223802000000000 0
1614224102000000000 0
1614224401000000000 0
1614224701000000000 0
1614225001000000000 0
1614225301000000000 0
1614225601000000000 0
1614225902000000000 0
1614226202000000000 0
1614226502000000000 0
1614226801000000000 0
1614227102000000000 0
1614227401000000000 0
1614227702000000000 0
1614228002000000000 0
1614228302000000000 0
1614228601000000000 0
1614228902000000000 0
1614229201000000000 0
1614229502000000000 0
1614229802000000000 0
1614230102000000000 0
1614230401000000000 0
1614230701000000000 0
1614231001000000000 0
1614231301000000000 0
1614231601000000000 0
1614231902000000000 0
1614232202000000000 0
1614232502000000000 0
1614232802000000000 0
1614233101000000000 0
1614233402000000000 0
1614233701000000000 0
1614234002000000000 0
1614234302000000000 0
1614234601000000000 0
1614234901000000000 0
1614235202000000000 0
1614235501000000000 0
1614235801000000000 0
1614236102000000000 0
1614236402000000000 0
1614236701000000000 0
1614237001000000000 0
1614237301000000000 0
1614237602000000000 0
1614237901000000000 0
1614238202000000000 0
1614238502000000000 0
1614238802000000000 0
1614239101000000000 0
1614239402000000000 0
1614239702000000000 0
1614240001000000000 0
1614240302000000000 0
1614240602000000000 0
1614240902000000000 0
1614241201000000000 0
1614241502000000000 0
1614241802000000000 0
1614242102000000000 0
1614242402000000000 0
1614242701000000000 0
1614243001000000000 0
1614243302000000000 0
1614243602000000000 0
1614243902000000000 0
1614244202000000000 0
1614244502000000000 0
1614244802000000000 0
1614245101000000000 0
1614245401000000000 0
1614245702000000000 0
1614246001000000000 0
1614246302000000000 0
1614246602000000000 0
1614246902000000000 0
1614247202000000000 0
1614247501000000000 0
1614247801000000000 0
1614248101000000000 0
1614248401000000000 0
1614248701000000000 0
1614249002000000000 0
1614249301000000000 0
1614249602000000000 0
1614249901000000000 0
1614250201000000000 0
1614250501000000000 0
1614250802000000000 0
1614251102000000000 0
1614251402000000000 0
1614251701000000000 0
1614252001000000000 0
1614252302000000000 0
1614252601000000000 0
1614252902000000000 0
1614253201000000000 0
1614253501000000000 0
1614253802000000000 0
1614254101000000000 0
1614254402000000000 0
1614254701000000000 0
1614255001000000000 0
1614255302000000000 0
1614255602000000000 0
1614255902000000000 0
1614256202000000000 0
1614256501000000000 0
1614256802000000000 0
1614257101000000000 0
1614257401000000000 0
1614257702000000000 0
1614258002000000000 0
1614258302000000000 0
1614258602000000000 0
1614258902000000000 0
1614259202000000000 0
1614259502000000000 0
1614259802000000000 0
1614260102000000000 0
1614260402000000000 0
1614260702000000000 0
1614261002000000000 0
1614261302000000000 0
1614261601000000000 0
1614261901000000000 0
1614262201000000000 0
1614262502000000000 0
1614262802000000000 0
1614263102000000000 0
1614263402000000000 0
1614263701000000000 0
1614264002000000000 0
1614264302000000000 0
1614264601000000000 0
1614264902000000000 0
1614265202000000000 0
1614265501000000000 0
1614265801000000000 0
1614266101000000000 0
1614266401000000000 0
1614266701000000000 0
1614267001000000000 0
1614267301000000000 0
1614267602000000000 0
1614267901000000000 0
1614268202000000000 0
1614268502000000000 0
1614268802000000000 0
1614269102000000000 0
1614269401000000000 0
1614269702000000000 0
1614270001000000000 0
1614270301000000000 0
1614270602000000000 0
1614270901000000000 0
1614271202000000000 0
1614271501000000000 0
1614271801000000000 0
1614272102000000000 0
1614272401000000000 0
1614272701000000000 0
1614273001000000000 0
1614273302000000000 0
1614273601000000000 0
1614273901000000000 0
1614274202000000000 0
1614274501000000000 0
1614274802000000000 0
1614275102000000000 0
1614275402000000000 0
1614275702000000000 0
1614276001000000000 0
1614276301000000000 0
1614276601000000000 0
1614276901000000000 0
1614277202000000000 0
1614277501000000000 0
1614277801000000000 0
1614278102000000000 0
1614278401000000000 0
1614278702000000000 0
1614279001000000000 0
1614279302000000000 0
1614279601000000000 0
1614279902000000000 0
1614280201000000000 0
1614280502000000000 0
1614280802000000000 0
1614281102000000000 0
1614281402000000000 0
1614281702000000000 0
1614282002000000000 0
1614282302000000000 0
1614282602000000000 0
1614282902000000000 0
1614283202000000000 0
1614283501000000000 0
1614283802000000000 0
1614284102000000000 0
1614284402000000000 0
1614284701000000000 0
1614285002000000000 0
1614285302000000000 0
1614285602000000000 0
1614285901000000000 0
1614286202000000000 0
1614286502000000000 0
1614286802000000000 0
1614287101000000000 0
1614287401000000000 0
1614287702000000000 0
1614288002000000000 0
1614288301000000000 0
1614288601000000000 0
1614288902000000000 0
1614289202000000000 0
1614289502000000000 0
1614289802000000000 0
1614290101000000000 0
1614290402000000000 0
1614290701000000000 0
1614291001000000000 0
1614291302000000000 0
1614291602000000000 0
1614291902000000000 0
1614292201000000000 0
1614292501000000000 0
1614292802000000000 0
1614293101000000000 0
1614293402000000000 0
1614293701000000000 0
1614294002000000000 0
1614294302000000000 0
1614294602000000000 0
1614294902000000000 0
1614295202000000000 0
1614295501000000000 0
1614295802000000000 0
1614296101000000000 0
1614296401000000000 0
1614296701000000000 0
1614297001000000000 0
1614297301000000000 0
1614297601000000000 0
1614297902000000000 0
1614298202000000000 0
1614298501000000000 0
1614298802000000000 0
1614299102000000000 0
1614299402000000000 0
1614299702000000000 0
1614300002000000000 0
1614300302000000000 0
1614300602000000000 0
1614300902000000000 0
1614301202000000000 0
1614301502000000000 0
1614301802000000000 0
1614302101000000000 0
1614302402000000000 0
1614302702000000000 0
1614303002000000000 0
1614303301000000000 0
1614303602000000000 0
1614303901000000000 0
1614304202000000000 0
1614304501000000000 0
1614304802000000000 0
1614305102000000000 0
1614305401000000000 0
1614305701000000000 0
1614306001000000000 0
1614306302000000000 0
1614306601000000000 0
1614306902000000000 0
1614307201000000000 0
1614307502000000000 0
1614307801000000000 0
1614308101000000000 0
1614308401000000000 0
1614308701000000000 0
1614309001000000000 0
1614309301000000000 0
1614309602000000000 0
1614309901000000000 0
1614310202000000000 0
1614310501000000000 0
1614310802000000000 0
1614311101000000000 0
1614311401000000000 0
1614311701000000000 0
1614312002000000000 0
1614312302000000000 0
1614312601000000000 0
1614312901000000000 0
1614313202000000000 0
1614313501000000000 0
1614313801000000000 0
1614314102000000000 0
1614314402000000000 0
1614314702000000000 0
1614315001000000000 0
1614315302000000000 0
1614315601000000000 0
1614315902000000000 0
1614316202000000000 0
1614316501000000000 0
1614316802000000000 0
1614317102000000000 0
1614317401000000000 0
1614317702000000000 0
1614318002000000000 0
1614318301000000000 0
1614318601000000000 0
1614318901000000000 0
1614319202000000000 0
1614319502000000000 0
1614319801000000000 0
1614320102000000000 0
1614320402000000000 0
1614320701000000000 0
1614321001000000000 0
1614321302000000000 0
1614321602000000000 0
1614321901000000000 0
1614322201000000000 0
1614322502000000000 0
1614322801000000000 0
1614323101000000000 0
1614323401000000000 0
1614323702000000000 0
1614324001000000000 0
1614324302000000000 0
1614324601000000000 0
1614324902000000000 0
1614325201000000000 0
1614325502000000000 0
1614325801000000000 0
1614326102000000000 0
1614326402000000000 0
1614326701000000000 0
1614327001000000000 0
1614327301000000000 0
1614327602000000000 0
1614327901000000000 0
1614328202000000000 0
1614328501000000000 0
1614328801000000000 0
1614329102000000000 0
1614329401000000000 0
1614329702000000000 0
1614330002000000000 0
1614330302000000000 0
1614330602000000000 0
1614330901000000000 0
1614331202000000000 0
1614331501000000000 0
1614331801000000000 0
1614332102000000000 0
1614332401000000000 0
1614332702000000000 0
1614333001000000000 0
1614333302000000000 0
1614333601000000000 0
1614333901000000000 0
1614334202000000000 0
1614334501000000000 0
1614334802000000000 0
1614335101000000000 0
1614335401000000000 0
1614335701000000000 0
1614336001000000000 0
1614336302000000000 0
1614336602000000000 0
1614336902000000000 0
1614337202000000000 0
1614337501000000000 0
1614337801000000000 0
1614338101000000000 0
1614338401000000000 0
1614338702000000000 0
1614339001000000000 0
1614339302000000000 0
1614339602000000000 0
1614339901000000000 0
1614340202000000000 0
1614340502000000000 0
1614340801000000000 0
1614341101000000000 0
1614341402000000000 0
1614341701000000000 0
1614342002000000000 0
1614342302000000000 0
1614342601000000000 0
1614342901000000000 0
1614343202000000000 0
1614343501000000000 0
1614343801000000000 0
1614344102000000000 0
1614344402000000000 0
1614344701000000000 0
1614345002000000000 0
1614345301000000000 0
1614345602000000000 0
1614345901000000000 0
1614346202000000000 0
1614346502000000000 0
1614346802000000000 0
1614347101000000000 0
1614347402000000000 0
1614347702000000000 0
1614348001000000000 0
1614348301000000000 0
1614348602000000000 0
1614348902000000000 0
1614349202000000000 0
1614349502000000000 0
1614349802000000000 0
1614350101000000000 0
1614350401000000000 0
1614350702000000000 0
1614351002000000000 0
1614351301000000000 0
1614351601000000000 0
1614351902000000000 0
1614352202000000000 0
1614352501000000000 0
1614352801000000000 0
1614353101000000000 0
1614353402000000000 0
1614353701000000000 0
1614354002000000000 0
1614354301000000000 0
1614354601000000000 0
1614354902000000000 0
1614355202000000000 0
1614355501000000000 0
1614355802000000000 0
1614356102000000000 0
1614356402000000000 0
1614356702000000000 0
1614357002000000000 0
1614357302000000000 0
1614357601000000000 0
"""

timestamps = []

for line in a.splitlines():
    timestamp_str,trash = line.split()
    timestamps.append(int(timestamp_str[:10]))

import time
start = time.time()

THREAD_COUNT = 3


def chunks(l, n):
    """Yield n number of striped chunks from l."""
    for i in range(0, n):
        yield l[i::n]

chunky = list(chunks(timestamps,THREAD_COUNT))


def worker(time_chunks):
    for timestamp in time_chunks:
        print("FIXING %s" %timestamp)
        try:
            peru_analyzer(timestamp)
        except:
            print("ERROR: FAILED TO FIX %s" % timestamp)

threads = []

for chunks in chunky:
    t = Thread(target=worker, args=(chunks,))
    t.start()
    threads.append(t)

for t in threads:
    t.join()


print("TOTAL TIME USED TO FIX THIS: %s" % (time.time() - start))
